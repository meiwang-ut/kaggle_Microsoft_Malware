HEADER:10000000							;
HEADER:10000000							; +-------------------------------------------------------------------------+
HEADER:10000000							; |   This file	has been generated by The Interactive Disassembler (IDA)    |
HEADER:10000000							; |	      Copyright	(c) 2013 Hex-Rays, <support@hex-rays.com>	    |
HEADER:10000000							; |			 License info:                			    |
HEADER:10000000							; |				   Microsoft				    |
HEADER:10000000							; +-------------------------------------------------------------------------+
HEADER:10000000							;
HEADER:10000000
HEADER:10000000
HEADER:10000000									include	uni.inc	; see unicode subdir of	ida for	info on	unicode
HEADER:10000000
HEADER:10000000									.686p
HEADER:10000000									.mmx
HEADER:10000000									.model flat
HEADER:10000000
HEADER:10000000							; ===========================================================================
HEADER:10000000
HEADER:10000000							; [00001000 BYTES: COLLAPSED SEGMENT HEADER. PRESS KEYPAD CTRL-"+" TO EXPAND]
.text:10001000						       ; 
.text:10001000						       ; Format	     : Portable	executable for 80386 (PE)
.text:10001000						       ; Imagebase   : 10000000
.text:10001000						       ; Section 1. (virtual address 00001000)
.text:10001000						       ; Virtual size		       : 000006AD (   1709.)
.text:10001000						       ; Section size in file	       : 00000800 (   2048.)
.text:10001000						       ; Offset	to raw data for	section: 00000400
.text:10001000						       ; Flags 60000020: Text Executable Readable
.text:10001000						       ; Alignment     : default
.text:10001000						       ; ===========================================================================
.text:10001000
.text:10001000						       ; Segment type: Pure code
.text:10001000						       ; Segment permissions: Read/Execute
.text:10001000						       _text	       segment para public 'CODE' use32
.text:10001000								       assume cs:_text
.text:10001000								       ;org 10001000h
.text:10001000								       assume es:nothing, ss:nothing, ds:_data,	fs:nothing, gs:nothing
.text:10001000
.text:10001000						       ; =============== S U B R O U T I N E =======================================
.text:10001000
.text:10001000
.text:10001000						       sub_10001000    proc near	       ; CODE XREF: RunPhotoDownloader+97p
.text:10001000											       ; RunPhotoDownloader+A5p ...
.text:10001000
.text:10001000						       var_2C	       = dword ptr -2Ch
.text:10001000						       var_28	       = byte ptr -28h
.text:10001000						       var_C	       = dword ptr -0Ch
.text:10001000						       var_4	       = dword ptr -4
.text:10001000						       arg_0	       = dword ptr  4
.text:10001000						       arg_4	       = dword ptr  8
.text:10001000						       arg_8	       = dword ptr  0Ch
.text:10001000
.text:10001000 6A FF							       push    0FFFFFFFFh
.text:10001002 68 A3 16	00 10						       push    offset SEH_10001000
.text:10001007 64 A1 00	00 00 00					       mov     eax, large fs:0
.text:1000100D 50							       push    eax
.text:1000100E 64 89 25	00 00 00 00					       mov     large fs:0, esp
.text:10001015 83 EC 20							       sub     esp, 20h
.text:10001018 8B 44 24	34						       mov     eax, [esp+2Ch+arg_4]
.text:1000101C 56							       push    esi
.text:1000101D 50							       push    eax
.text:1000101E 8D 4C 24	0C						       lea     ecx, [esp+34h+var_28]
.text:10001022 C7 44 24	08 00 00 00 00					       mov     [esp+34h+var_2C], 0
.text:1000102A FF 15 34	20 00 10					       call    ds:??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@ABV01@@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>> const &)
.text:10001030 8B 4C 24	3C						       mov     ecx, [esp+30h+arg_8]
.text:10001034 51							       push    ecx
.text:10001035 8B C8							       mov     ecx, eax
.text:10001037 C7 44 24	30 01 00 00 00					       mov     [esp+34h+var_4],	1
.text:1000103F FF 15 3C	20 00 10					       call    ds:??Y?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAEAAV01@PBG@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::operator+=(ushort	const *)
.text:10001045 8B 74 24	34						       mov     esi, [esp+30h+arg_0]
.text:10001049 50							       push    eax
.text:1000104A 8B CE							       mov     ecx, esi
.text:1000104C FF 15 34	20 00 10					       call    ds:??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@ABV01@@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>> const &)
.text:10001052 8D 4C 24	08						       lea     ecx, [esp+30h+var_28]
.text:10001056 C7 44 24	04 01 00 00 00					       mov     [esp+30h+var_2C], 1
.text:1000105E C6 44 24	2C 00						       mov     byte ptr	[esp+30h+var_4], 0
.text:10001063 FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:10001069 8B 4C 24	24						       mov     ecx, [esp+30h+var_C]
.text:1000106D 8B C6							       mov     eax, esi
.text:1000106F 5E							       pop     esi
.text:10001070 64 89 0D	00 00 00 00					       mov     large fs:0, ecx
.text:10001077 83 C4 2C							       add     esp, 2Ch
.text:1000107A C3							       retn
.text:1000107A						       sub_10001000    endp
.text:1000107A
.text:1000107A						       ; ---------------------------------------------------------------------------
.text:1000107B CC CC CC	CC CC						       align 10h
.text:10001080						       ; Exported entry	  1. RunPhotoDownloader
.text:10001080
.text:10001080						       ; =============== S U B R O U T I N E =======================================
.text:10001080
.text:10001080						       ; Attributes: bp-based frame
.text:10001080
.text:10001080						       ; int __cdecl RunPhotoDownloader(__int32	Value, DWORD flProtect,	int)
.text:10001080								       public RunPhotoDownloader
.text:10001080						       RunPhotoDownloader proc near	       ; DATA XREF: .rdata:off_100026B8o
.text:10001080
.text:10001080						       hObject	       = dword ptr -32Ch
.text:10001080						       hModule	       = dword ptr -328h
.text:10001080						       Msg	       = tagMSG	ptr -31Ch
.text:10001080						       var_300	       = dword ptr -300h
.text:10001080						       var_2FC	       = dword ptr -2FCh
.text:10001080						       var_2E8	       = byte ptr -2E8h
.text:10001080						       var_2E4	       = byte ptr -2E4h
.text:10001080						       var_2E0	       = byte ptr -2E0h
.text:10001080						       var_2C0	       = dword ptr -2C0h
.text:10001080						       var_298	       = byte ptr -298h
.text:10001080						       lpAddress       = dword ptr -27Ch
.text:10001080						       var_278	       = byte ptr -278h
.text:10001080						       var_274	       = byte ptr -274h
.text:10001080						       var_270	       = dword ptr -270h
.text:10001080						       var_268	       = dword ptr -268h
.text:10001080						       var_25C	       = dword ptr -25Ch
.text:10001080						       Dest	       = word ptr -258h
.text:10001080						       var_214	       = byte ptr -214h
.text:10001080						       var_210	       = byte ptr -210h
.text:10001080						       var_1CE	       = byte ptr -1CEh
.text:10001080						       var_28	       = dword ptr -28h
.text:10001080						       var_4	       = dword ptr -4
.text:10001080						       Value	       = dword ptr  8
.text:10001080						       flProtect       = dword ptr  0Ch
.text:10001080						       arg_8	       = dword ptr  10h
.text:10001080
.text:10001080 55							       push    ebp
.text:10001081 8B EC							       mov     ebp, esp
.text:10001083 83 E4 F8							       and     esp, 0FFFFFFF8h
.text:10001086 81 EC 0C	03 00 00					       sub     esp, 30Ch
.text:1000108C 8B 55 08							       mov     edx, [ebp+Value]
.text:1000108F 85 D2							       test    edx, edx
.text:10001091 A1 20 30	00 10						       mov     eax, ___security_cookie
.text:10001096 53							       push    ebx
.text:10001097 56							       push    esi
.text:10001098 89 84 24	10 03 00 00					       mov     [esp+314h+var_4], eax
.text:1000109F 57							       push    edi
.text:100010A0 0F 84 1B	02 00 00					       jz      loc_100012C1
.text:100010A6 8B 5D 0C							       mov     ebx, [ebp+flProtect]
.text:100010A9 85 DB							       test    ebx, ebx
.text:100010AB 0F 84 10	02 00 00					       jz      loc_100012C1
.text:100010B1 B9 10 00	00 00						       mov     ecx, 10h
.text:100010B6 BE B0 20	00 10						       mov     esi, offset aParamsForceTru ; " params force=true parenthandle="
.text:100010BB 8D BC 24	08 01 00 00					       lea     edi, [esp+318h+var_210]
.text:100010C2 F3 A5							       rep movsd
.text:100010C4 66 A5							       movsw
.text:100010C6 33 C0							       xor     eax, eax
.text:100010C8 B9 71 00	00 00						       mov     ecx, 71h
.text:100010CD 8D BC 24	4A 01 00 00					       lea     edi, [esp+318h+var_1CE]
.text:100010D4 F3 AB							       rep stosd
.text:100010D6 66 AB							       stosw
.text:100010D8 6A 10							       push    10h	       ; Radix
.text:100010DA 8D 84 24	C4 00 00 00					       lea     eax, [esp+31Ch+Dest]
.text:100010E1 50							       push    eax	       ; Dest
.text:100010E2 52							       push    edx	       ; Value
.text:100010E3 FF 15 4C	20 00 10					       call    ds:_ltow
.text:100010E9 83 C4 0C							       add     esp, 0Ch
.text:100010EC 53							       push    ebx	       ; flProtect
.text:100010ED 8D 8C 24	A8 00 00 00					       lea     ecx, [esp+31Ch+var_274]
.text:100010F4 FF 15 38	20 00 10					       call    ds:??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@PBG@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(ushort const *)
.text:100010FA 8D 8C 24	C0 00 00 00					       lea     ecx, [esp+31Ch+var_25C]
.text:10001101 51							       push    ecx
.text:10001102 8D 94 24	0C 01 00 00					       lea     edx, [esp+320h+var_214]
.text:10001109 52							       push    edx
.text:1000110A 8D 84 24	AC 00 00 00					       lea     eax, [esp+324h+var_278]
.text:10001111 50							       push    eax
.text:10001112 8D 4C 24	48						       lea     ecx, [esp+328h+var_2E0]
.text:10001116 51							       push    ecx
.text:10001117 E8 E4 FE	FF FF						       call    sub_10001000
.text:1000111C 83 C4 0C							       add     esp, 0Ch
.text:1000111F 50							       push    eax
.text:10001120 8D 54 24	28						       lea     edx, [esp+324h+var_2FC]
.text:10001124 52							       push    edx
.text:10001125 E8 D6 FE	FF FF						       call    sub_10001000
.text:1000112A 83 C4 0C							       add     esp, 0Ch
.text:1000112D 50							       push    eax	       ; flAllocationType
.text:1000112E 8D 8C 24	A8 00 00 00					       lea     ecx, [esp+320h+var_278]
.text:10001135 FF 15 40	20 00 10					       call    ds:??4?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAEAAV01@ABV01@@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::operator=(std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>> const &)
.text:1000113B 8D 4C 24	20						       lea     ecx, [esp+320h+var_300]
.text:1000113F FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:10001145 8D 4C 24	3C						       lea     ecx, [esp+320h+var_2E4]
.text:10001149 FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:1000114F 8B 45 10							       mov     eax, [ebp+arg_8]
.text:10001152 85 C0							       test    eax, eax
.text:10001154 74 4B							       jz      short loc_100011A1
.text:10001156 50							       push    eax
.text:10001157 68 AC 20	00 10						       push    offset unk_100020AC
.text:1000115C 8D 84 24	AC 00 00 00					       lea     eax, [esp+328h+lpAddress]
.text:10001163 50							       push    eax
.text:10001164 8D 4C 24	2C						       lea     ecx, [esp+32Ch+var_300]
.text:10001168 51							       push    ecx
.text:10001169 E8 92 FE	FF FF						       call    sub_10001000
.text:1000116E 83 C4 0C							       add     esp, 0Ch
.text:10001171 50							       push    eax
.text:10001172 8D 54 24	44						       lea     edx, [esp+328h+var_2E4]
.text:10001176 52							       push    edx
.text:10001177 E8 84 FE	FF FF						       call    sub_10001000
.text:1000117C 83 C4 0C							       add     esp, 0Ch
.text:1000117F 50							       push    eax	       ; dwSize
.text:10001180 8D 8C 24	A8 00 00 00					       lea     ecx, [esp+324h+lpAddress]
.text:10001187 FF 15 40	20 00 10					       call    ds:??4?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAEAAV01@ABV01@@Z ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::operator=(std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>> const &)
.text:1000118D 8D 4C 24	3C						       lea     ecx, [esp+324h+var_2E8]
.text:10001191 FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:10001197 8D 4C 24	20						       lea     ecx, [esp+324h+Msg.pt.y]
.text:1000119B FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:100011A1
.text:100011A1						       loc_100011A1:			       ; CODE XREF: RunPhotoDownloader+D4j
.text:100011A1 8B 84 24	BC 00 00 00					       mov     eax, [esp+324h+var_268]
.text:100011A8 BE 08 00	00 00						       mov     esi, 8
.text:100011AD 3B C6							       cmp     eax, esi
.text:100011AF 8B 84 24	A8 00 00 00					       mov     eax, [esp+324h+lpAddress]
.text:100011B6 73 07							       jnb     short loc_100011BF
.text:100011B8 8D 84 24	A8 00 00 00					       lea     eax, [esp+324h+lpAddress]
.text:100011BF
.text:100011BF						       loc_100011BF:			       ; CODE XREF: RunPhotoDownloader+136j
.text:100011BF 50							       push    eax	       ; lpAddress
.text:100011C0 FF 15 0C	20 00 10					       call    ds:VirtualAlloc
.text:100011C6 33 C0							       xor     eax, eax
.text:100011C8 B9 11 00	00 00						       mov     ecx, 11h
.text:100011CD 8D 7C 24	58						       lea     edi, [esp+318h+var_2C0]
.text:100011D1 F3 AB							       rep stosd
.text:100011D3 89 44 24	10						       mov     [esp+318h+Msg.pt.x], eax
.text:100011D7 89 44 24	14						       mov     [esp+318h+Msg.pt.y], eax
.text:100011DB 89 44 24	18						       mov     [esp+318h+var_300], eax
.text:100011DF 89 44 24	1C						       mov     [esp+318h+var_2FC], eax
.text:100011E3 39 B4 24	BC 00 00 00					       cmp     [esp+318h+var_25C], esi
.text:100011EA 8B 84 24	A8 00 00 00					       mov     eax, [esp+318h+var_270]
.text:100011F1 C7 44 24	58 44 00 00 00					       mov     [esp+318h+var_2C0], 44h
.text:100011F9 73 07							       jnb     short loc_10001202
.text:100011FB 8D 84 24	A8 00 00 00					       lea     eax, [esp+318h+var_270]
.text:10001202
.text:10001202						       loc_10001202:			       ; CODE XREF: RunPhotoDownloader+179j
.text:10001202 8D 4C 24	10						       lea     ecx, [esp+318h+Msg.pt]
.text:10001206 51							       push    ecx
.text:10001207 8D 54 24	5C						       lea     edx, [esp+31Ch+var_2C0]
.text:1000120B 52							       push    edx
.text:1000120C 6A 00							       push    0
.text:1000120E 6A 00							       push    0
.text:10001210 6A 00							       push    0
.text:10001212 6A 00							       push    0
.text:10001214 6A 00							       push    0
.text:10001216 6A 00							       push    0
.text:10001218 50							       push    eax
.text:10001219 6A 00							       push    0	       ; lpLibFileName
.text:1000121B FF 15 08	20 00 10					       call    ds:LoadLibraryA
.text:10001221 85 C0							       test    eax, eax
.text:10001223 0F 84 8B	00 00 00					       jz      loc_100012B4
.text:10001229 8B 44 24	14						       mov     eax, [esp+33Ch+hModule]
.text:1000122D 8B 3D 04	20 00 10					       mov     edi, ds:GetProcAddress
.text:10001233 6A 00							       push    0	       ; lpProcName
.text:10001235 50							       push    eax	       ; hModule
.text:10001236 FF D7							       call    edi ; GetProcAddress
.text:10001238 85 C0							       test    eax, eax
.text:1000123A 76 42							       jbe     short loc_1000127E
.text:1000123C 8B 35 7C	20 00 10					       mov     esi, ds:GetMessageW
.text:10001242 8B 1D 78	20 00 10					       mov     ebx, ds:DispatchMessageW
.text:10001248
.text:10001248						       loc_10001248:			       ; CODE XREF: RunPhotoDownloader+1FCj
.text:10001248 6A 00							       push    0	       ; wMsgFilterMax
.text:1000124A 6A 00							       push    0	       ; wMsgFilterMin
.text:1000124C 6A 00							       push    0	       ; hWnd
.text:1000124E 8D 4C 24	2C						       lea     ecx, [esp+348h+Msg]
.text:10001252 51							       push    ecx	       ; lpMsg
.text:10001253 FF D6							       call    esi ; GetMessageW
.text:10001255 83 F8 FF							       cmp     eax, 0FFFFFFFFh
.text:10001258 74 17							       jz      short loc_10001271
.text:1000125A 8B 44 24	24						       mov     eax, [esp+33Ch+Msg.message]
.text:1000125E 3D 03 20	00 00						       cmp     eax, 2003h
.text:10001263 74 19							       jz      short loc_1000127E
.text:10001265 83 F8 0F							       cmp     eax, 0Fh
.text:10001268 75 07							       jnz     short loc_10001271
.text:1000126A 8D 54 24	20						       lea     edx, [esp+33Ch+Msg]
.text:1000126E 52							       push    edx	       ; lpMsg
.text:1000126F FF D3							       call    ebx ; DispatchMessageW
.text:10001271
.text:10001271						       loc_10001271:			       ; CODE XREF: RunPhotoDownloader+1D8j
.text:10001271											       ; RunPhotoDownloader+1E8j
.text:10001271 8B 44 24	14						       mov     eax, [esp+33Ch+hModule]
.text:10001275 6A 00							       push    0	       ; lpProcName
.text:10001277 50							       push    eax	       ; hModule
.text:10001278 FF D7							       call    edi ; GetProcAddress
.text:1000127A 85 C0							       test    eax, eax
.text:1000127C 77 CA							       ja      short loc_10001248
.text:1000127E
.text:1000127E						       loc_1000127E:			       ; CODE XREF: RunPhotoDownloader+1BAj
.text:1000127E											       ; RunPhotoDownloader+1E3j
.text:1000127E 8B 4C 24	10						       mov     ecx, [esp+33Ch+hObject]
.text:10001282 8B 35 00	20 00 10					       mov     esi, ds:CloseHandle
.text:10001288 51							       push    ecx	       ; hObject
.text:10001289 FF D6							       call    esi ; CloseHandle
.text:1000128B 8B 54 24	14						       mov     edx, [esp+33Ch+hModule]
.text:1000128F 52							       push    edx	       ; hObject
.text:10001290 FF D6							       call    esi ; CloseHandle
.text:10001292 8D 8C 24	A4 00 00 00					       lea     ecx, [esp+33Ch+var_298]
.text:10001299 FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:1000129F B0 01							       mov     al, 1
.text:100012A1 8B 8C 24	14 03 00 00					       mov     ecx, [esp+33Ch+var_28]
.text:100012A8 E8 64 00	00 00						       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:100012AD 5F							       pop     edi
.text:100012AE 5E							       pop     esi
.text:100012AF 5B							       pop     ebx
.text:100012B0 8B E5							       mov     esp, ebp
.text:100012B2 5D							       pop     ebp
.text:100012B3 C3							       retn
.text:100012B4						       ; ---------------------------------------------------------------------------
.text:100012B4
.text:100012B4						       loc_100012B4:			       ; CODE XREF: RunPhotoDownloader+1A3j
.text:100012B4 8D 8C 24	A4 00 00 00					       lea     ecx, [esp+33Ch+var_298]
.text:100012BB FF 15 30	20 00 10					       call    ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:100012C1
.text:100012C1						       loc_100012C1:			       ; CODE XREF: RunPhotoDownloader+20j
.text:100012C1											       ; RunPhotoDownloader+2Bj
.text:100012C1 8B 8C 24	14 03 00 00					       mov     ecx, [esp+33Ch+var_28]
.text:100012C8 32 C0							       xor     al, al
.text:100012CA E8 42 00	00 00						       call    @__security_check_cookie@4 ; __security_check_cookie(x)
.text:100012CF 5F							       pop     edi
.text:100012D0 5E							       pop     esi
.text:100012D1 5B							       pop     ebx
.text:100012D2 8B E5							       mov     esp, ebp
.text:100012D4 5D							       pop     ebp
.text:100012D5 C3							       retn
.text:100012D5						       RunPhotoDownloader endp ; sp-analysis failed
.text:100012D5
.text:100012D6						       ; [00000006 BYTES: COLLAPSED FUNCTION __CxxFrameHandler.	PRESS KEYPAD CTRL-"+" TO EXPAND]
.text:100012DC CC CC CC	CC						       align 10h
.text:100012E0						       ; [0000001D BYTES: COLLAPSED CHUNK OF FUNCTION __security_check_cookie(x). PRESS	KEYPAD CTRL-"+"	TO EXPAND]
.text:100012FD
.text:100012FD						       ; =============== S U B R O U T I N E =======================================
.text:100012FD
.text:100012FD
.text:100012FD						       sub_100012FD    proc near	       ; DATA XREF: .rdata:100020FCo
.text:100012FD 33 C0							       xor     eax, eax
.text:100012FF 40							       inc     eax
.text:10001300 C3							       retn
.text:10001300						       sub_100012FD    endp
.text:10001300
.text:10001301
.text:10001301						       ; =============== S U B R O U T I N E =======================================
.text:10001301
.text:10001301
.text:10001301						       sub_10001301    proc near	       ; DATA XREF: .rdata:10002100o
.text:10001301 8B 65 E8							       mov     esp, [ebp-18h]
.text:10001301						       sub_10001301    endp ; sp-analysis failed
.text:10001301
.text:10001304						       ; [0000000C BYTES: COLLAPSED CHUNK OF FUNCTION __security_check_cookie(x). PRESS	KEYPAD CTRL-"+"	TO EXPAND]
.text:10001310 CC							       db 0CCh
.text:10001311						       ; [0000000E BYTES: COLLAPSED FUNCTION __security_check_cookie(x). PRESS KEYPAD CTRL-"+" TO EXPAND]
.text:1000131F						       ; ---------------------------------------------------------------------------
.text:1000131F 8B 44 24	08						       mov     eax, [esp+8]
.text:10001323 85 C0							       test    eax, eax
.text:10001325 75 0E							       jnz     short loc_10001335
.text:10001327 39 05 24	30 00 10					       cmp     dword_10003024, eax
.text:1000132D 7E 2E							       jle     short loc_1000135D
.text:1000132F FF 0D 24	30 00 10					       dec     dword_10003024
.text:10001335
.text:10001335						       loc_10001335:			       ; CODE XREF: .text:10001325j
.text:10001335 83 F8 01							       cmp     eax, 1
.text:10001338 8B 0D 64	20 00 10					       mov     ecx, ds:_adjust_fdiv
.text:1000133E 8B 09							       mov     ecx, [ecx]
.text:10001340 89 0D 28	30 00 10					       mov     dword_10003028, ecx
.text:10001346 75 4F							       jnz     short loc_10001397
.text:10001348 68 80 00	00 00						       push    80h
.text:1000134D FF 15 60	20 00 10					       call    ds:malloc
.text:10001353 85 C0							       test    eax, eax
.text:10001355 59							       pop     ecx
.text:10001356 A3 30 30	00 10						       mov     dword_10003030, eax
.text:1000135B 75 04							       jnz     short loc_10001361
.text:1000135D
.text:1000135D						       loc_1000135D:			       ; CODE XREF: .text:1000132Dj
.text:1000135D 33 C0							       xor     eax, eax
.text:1000135F EB 79							       jmp     short locret_100013DA
.text:10001361						       ; ---------------------------------------------------------------------------
.text:10001361
.text:10001361						       loc_10001361:			       ; CODE XREF: .text:1000135Bj
.text:10001361 83 20 00							       and     dword ptr [eax],	0
.text:10001364 A1 30 30	00 10						       mov     eax, dword_10003030
.text:10001369 A3 2C 30	00 10						       mov     dword_1000302C, eax
.text:1000136E E8 4D 02	00 00						       call    sub_100015C0
.text:10001373 68 04 16	00 10						       push    offset sub_10001604
.text:10001378 E8 31 02	00 00						       call    sub_100015AE
.text:1000137D C7 04 24	08 30 00 10					       mov     dword ptr [esp],	offset unk_10003008
.text:10001384 68 00 30	00 10						       push    offset unk_10003000
.text:10001389 E8 F4 01	00 00						       call    _initterm
.text:1000138E FF 05 24	30 00 10					       inc     dword_10003024
.text:10001394 59							       pop     ecx
.text:10001395 EB 3F							       jmp     short loc_100013D6
.text:10001397						       ; ---------------------------------------------------------------------------
.text:10001397
.text:10001397						       loc_10001397:			       ; CODE XREF: .text:10001346j
.text:10001397 85 C0							       test    eax, eax
.text:10001399 75 3C							       jnz     short loc_100013D7
.text:1000139B A1 30 30	00 10						       mov     eax, dword_10003030
.text:100013A0 85 C0							       test    eax, eax
.text:100013A2 74 33							       jz      short loc_100013D7
.text:100013A4 EB 13							       jmp     short loc_100013B9
.text:100013A6						       ; ---------------------------------------------------------------------------
.text:100013A6
.text:100013A6						       loc_100013A6:			       ; CODE XREF: .text:100013C6j
.text:100013A6 8B 0D 2C	30 00 10					       mov     ecx, dword_1000302C
.text:100013AC 8B 09							       mov     ecx, [ecx]
.text:100013AE 85 C9							       test    ecx, ecx
.text:100013B0 74 07							       jz      short loc_100013B9
.text:100013B2 FF D1							       call    ecx
.text:100013B4 A1 30 30	00 10						       mov     eax, dword_10003030
.text:100013B9
.text:100013B9						       loc_100013B9:			       ; CODE XREF: .text:100013A4j
.text:100013B9											       ; .text:100013B0j
.text:100013B9 83 2D 2C	30 00 10 04					       sub     dword_1000302C, 4
.text:100013C0 39 05 2C	30 00 10					       cmp     dword_1000302C, eax
.text:100013C6 73 DE							       jnb     short loc_100013A6
.text:100013C8 50							       push    eax
.text:100013C9 FF 15 58	20 00 10					       call    ds:free
.text:100013CF 83 25 30	30 00 10 00					       and     dword_10003030, 0
.text:100013D6
.text:100013D6						       loc_100013D6:			       ; CODE XREF: .text:10001395j
.text:100013D6 59							       pop     ecx
.text:100013D7
.text:100013D7						       loc_100013D7:			       ; CODE XREF: .text:10001399j
.text:100013D7											       ; .text:100013A2j
.text:100013D7 33 C0							       xor     eax, eax
.text:100013D9 40							       inc     eax
.text:100013DA
.text:100013DA						       locret_100013DA:			       ; CODE XREF: .text:1000135Fj
.text:100013DA C2 0C 00							       retn    0Ch
.text:100013DD						       ; ---------------------------------------------------------------------------
.text:100013DD
.text:100013DD						       ; BOOL __stdcall	DllEntryPoint(HINSTANCE	hinstDLL, DWORD	fdwReason, LPVOID lpReserved)
.text:100013DD								       public DllEntryPoint
.text:100013DD						       DllEntryPoint:
.text:100013DD 83 EC 04							       sub     esp, 4
.text:100013E0 60							       pusha
.text:100013E1 BB 10 00	00 00						       mov     ebx, 10h
.text:100013E6 8D 4C 5B	10						       lea     ecx, [ebx+ebx*2+10h]
.text:100013EA 51							       push    ecx
.text:100013EB B9 01 00	00 00						       mov     ecx, 1
.text:100013F0 C1 E1 0C							       shl     ecx, 0Ch
.text:100013F3 51							       push    ecx
.text:100013F4 BF 00 04	00 00						       mov     edi, 400h
.text:100013F9 81 C7 00	04 00 00					       add     edi, 400h
.text:100013FF 57							       push    edi
.text:10001400 6A 00							       push    0
.text:10001402 FF 15 0C	20 00 10					       call    ds:VirtualAlloc
.text:10001408 50							       push    eax
.text:10001409 58							       pop     eax
.text:1000140A 31 F6							       xor     esi, esi
.text:1000140C 81 C6 38	41 00 10					       add     esi, offset unk_10004138
.text:10001412 8D 0E							       lea     ecx, [esi]
.text:10001414 8D 89 C8	BE FF EF					       lea     ecx, [ecx-10004138h]
.text:1000141A 51							       push    ecx
.text:1000141B 50							       push    eax
.text:1000141C 8B 3E							       mov     edi, [esi]
.text:1000141E 89 FA							       mov     edx, edi
.text:10001420 8D 76 04							       lea     esi, [esi+4]
.text:10001423
.text:10001423						       loc_10001423:			       ; CODE XREF: .text:10001435j
.text:10001423 0F B6 4C	16 FF						       movzx   ecx, byte ptr [esi+edx-1]
.text:10001428 31 DB							       xor     ebx, ebx
.text:1000142A 88 5C 10	FF						       mov     [eax+edx-1], bl
.text:1000142E 08 4C 10	FF						       or      [eax+edx-1], cl
.text:10001432 4A							       dec     edx
.text:10001433 09 D2							       or      edx, edx
.text:10001435 75 EC							       jnz     short loc_10001423
.text:10001437 5B							       pop     ebx
.text:10001438 53							       push    ebx
.text:10001439 8F 43 01							       pop     dword ptr [ebx+1]
.text:1000143C FF D3							       call    ebx
.text:1000143C						       ; ---------------------------------------------------------------------------
.text:1000143E C7 74							       dw 74C7h
.text:10001440 72 8B 5D	10 53 56 FF 75 08 E8 00	02 00 00 89 45+		       dd 105D8B72h, 75FF5653h,	200E808h, 45890000h, 1FE83E4h
.text:10001440 E4 83 FE	01 75 0E 3B C7 75 0A 53	57 FF 75 08 E8+		       dd 0C73B0E75h, 57530A75h, 0E80875FFh, 0FFFFFEBBh, 574F73Bh
.text:10001440 BB FE FF	FF 3B F7 74 05 83 FE 03	75 29 53 56 FF+		       dd 7503FE83h, 0FF565329h, 0A8E80875h, 85FFFFFEh,	890375C0h
.text:10001440 75 08 E8	A8 FE FF FF 85 C0 75 03	89 7D E4 39 7D+		       dd 7D39E47Dh, 0A11374E4h
.text:10001484 34 30 00	10						       dd offset dword_10003034
.text:10001488						       ; ---------------------------------------------------------------------------
.text:10001488 3B C7							       cmp     eax, edi
.text:1000148A 74 0A							       jz      short loc_10001496
.text:1000148C 53							       push    ebx
.text:1000148D 56							       push    esi
.text:1000148E FF 75 08							       push    dword ptr [ebp+8]
.text:10001491 FF D0							       call    eax
.text:10001493 89 45 E4							       mov     [ebp-1Ch], eax
.text:10001496
.text:10001496						       loc_10001496:			       ; CODE XREF: .text:1000148Aj
.text:10001496 83 4D FC	FF						       or      dword ptr [ebp-4], 0FFFFFFFFh
.text:1000149A 8B 45 E4							       mov     eax, [ebp-1Ch]
.text:1000149D EB 1A							       jmp     short loc_100014B9
.text:1000149F
.text:1000149F						       ; =============== S U B R O U T I N E =======================================
.text:1000149F
.text:1000149F
.text:1000149F						       sub_1000149F    proc near	       ; DATA XREF: .rdata:1000210Co
.text:1000149F 8B 45 EC							       mov     eax, [ebp-14h]
.text:100014A2 8B 08							       mov     ecx, [eax]
.text:100014A4 8B 09							       mov     ecx, [ecx]
.text:100014A6 50							       push    eax
.text:100014A7 51							       push    ecx
.text:100014A8 E8 9B 01	00 00						       call    __CppXcptFilter
.text:100014AD 59							       pop     ecx
.text:100014AE 59							       pop     ecx
.text:100014AF C3							       retn
.text:100014AF						       sub_1000149F    endp
.text:100014AF
.text:100014B0
.text:100014B0						       ; =============== S U B R O U T I N E =======================================
.text:100014B0
.text:100014B0
.text:100014B0						       sub_100014B0    proc near	       ; DATA XREF: .rdata:10002110o
.text:100014B0 8B 65 E8							       mov     esp, [ebp-18h]
.text:100014B3 83 4D FC	FF						       or      dword ptr [ebp-4], 0FFFFFFFFh
.text:100014B7 33 C0							       xor     eax, eax
.text:100014B9
.text:100014B9						       loc_100014B9:			       ; CODE XREF: .text:1000149Dj
.text:100014B9 E8 AD 00	00 00						       call    __SEH_epilog
.text:100014BE C2 0C 00							       retn    0Ch
.text:100014BE						       sub_100014B0    endp
.text:100014BE
.text:100014C1
.text:100014C1						       ; =============== S U B R O U T I N E =======================================
.text:100014C1
.text:100014C1						       ; Attributes: bp-based frame
.text:100014C1
.text:100014C1						       sub_100014C1    proc near	       ; DATA XREF: .data:10003004o
.text:100014C1
.text:100014C1						       PerformanceCount= LARGE_INTEGER ptr -10h
.text:100014C1						       SystemTimeAsFileTime= _FILETIME ptr -8
.text:100014C1
.text:100014C1 55							       push    ebp
.text:100014C2 8B EC							       mov     ebp, esp
.text:100014C4 83 EC 10							       sub     esp, 10h
.text:100014C7 A1 20 30	00 10						       mov     eax, ___security_cookie
.text:100014CC 85 C0							       test    eax, eax
.text:100014CE 74 07							       jz      short loc_100014D7
.text:100014D0 3D 4E E6	40 BB						       cmp     eax, 0BB40E64Eh
.text:100014D5 75 4E							       jnz     short locret_10001525
.text:100014D7
.text:100014D7						       loc_100014D7:			       ; CODE XREF: sub_100014C1+Dj
.text:100014D7 56							       push    esi
.text:100014D8 8D 45 F8							       lea     eax, [ebp+SystemTimeAsFileTime]
.text:100014DB 50							       push    eax	       ; lpSystemTimeAsFileTime
.text:100014DC FF 15 10	20 00 10					       call    ds:GetSystemTimeAsFileTime
.text:100014E2 8B 75 FC							       mov     esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
.text:100014E5 33 75 F8							       xor     esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
.text:100014E8 FF 15 14	20 00 10					       call    ds:GetCurrentProcessId
.text:100014EE 33 F0							       xor     esi, eax
.text:100014F0 FF 15 18	20 00 10					       call    ds:GetCurrentThreadId
.text:100014F6 33 F0							       xor     esi, eax
.text:100014F8 FF 15 1C	20 00 10					       call    ds:GetTickCount
.text:100014FE 33 F0							       xor     esi, eax
.text:10001500 8D 45 F0							       lea     eax, [ebp+PerformanceCount]
.text:10001503 50							       push    eax	       ; lpPerformanceCount
.text:10001504 FF 15 20	20 00 10					       call    ds:QueryPerformanceCounter
.text:1000150A 8B 45 F4							       mov     eax, dword ptr [ebp+PerformanceCount+4]
.text:1000150D 33 45 F0							       xor     eax, dword ptr [ebp+PerformanceCount]
.text:10001510 33 F0							       xor     esi, eax
.text:10001512 89 35 20	30 00 10					       mov     ___security_cookie, esi
.text:10001518 75 0A							       jnz     short loc_10001524
.text:1000151A C7 05 20	30 00 10 4E E6 40 BB				       mov     ___security_cookie, 0BB40E64Eh
.text:10001524
.text:10001524						       loc_10001524:			       ; CODE XREF: sub_100014C1+57j
.text:10001524 5E							       pop     esi
.text:10001525
.text:10001525						       locret_10001525:			       ; CODE XREF: sub_100014C1+14j
.text:10001525 C9							       leave
.text:10001526 C3							       retn
.text:10001526						       sub_100014C1    endp
.text:10001526
.text:10001526						       ; ---------------------------------------------------------------------------
.text:10001527 CC							       align 4
.text:10001528						       ; [00000006 BYTES: COLLAPSED FUNCTION __security_error_handler. PRESS KEYPAD CTRL-"+" TO	EXPAND]
.text:1000152E CC CC							       align 10h
.text:10001530						       ; [0000003B BYTES: COLLAPSED FUNCTION __SEH_prolog. PRESS KEYPAD	CTRL-"+" TO EXPAND]
.text:1000156B						       ; [00000011 BYTES: COLLAPSED FUNCTION __SEH_epilog. PRESS KEYPAD	CTRL-"+" TO EXPAND]
.text:1000157C						       ; [00000006 BYTES: COLLAPSED FUNCTION _except_handler3. PRESS KEYPAD CTRL-"+" TO	EXPAND]
.text:10001582						       ; [00000006 BYTES: COLLAPSED FUNCTION _initterm.	PRESS KEYPAD CTRL-"+" TO EXPAND]
.text:10001588
.text:10001588						       ; =============== S U B R O U T I N E =======================================
.text:10001588
.text:10001588
.text:10001588						       sub_10001588    proc near	       ; CODE XREF: sub_100015AE+4p
.text:10001588
.text:10001588						       arg_0	       = dword ptr  4
.text:10001588
.text:10001588 83 3D 30	30 00 10 FF					       cmp     dword_10003030, 0FFFFFFFFh
.text:1000158F 75 06							       jnz     short loc_10001597
.text:10001591 FF 25 70	20 00 10					       jmp     ds:_onexit
.text:10001597						       ; ---------------------------------------------------------------------------
.text:10001597
.text:10001597						       loc_10001597:			       ; CODE XREF: sub_10001588+7j
.text:10001597 68 2C 30	00 10						       push    offset dword_1000302C
.text:1000159C 68 30 30	00 10						       push    offset dword_10003030
.text:100015A1 FF 74 24	0C						       push    [esp+8+arg_0]
.text:100015A5 E8 C4 00	00 00						       call    __dllonexit
.text:100015AA 83 C4 0C							       add     esp, 0Ch
.text:100015AD C3							       retn
.text:100015AD						       sub_10001588    endp
.text:100015AD
.text:100015AE
.text:100015AE						       ; =============== S U B R O U T I N E =======================================
.text:100015AE
.text:100015AE
.text:100015AE						       sub_100015AE    proc near	       ; CODE XREF: .text:10001378p
.text:100015AE
.text:100015AE						       arg_0	       = dword ptr  4
.text:100015AE
.text:100015AE FF 74 24	04						       push    [esp+arg_0]
.text:100015B2 E8 D1 FF	FF FF						       call    sub_10001588
.text:100015B7 F7 D8							       neg     eax
.text:100015B9 1B C0							       sbb     eax, eax
.text:100015BB F7 D8							       neg     eax
.text:100015BD 59							       pop     ecx
.text:100015BE 48							       dec     eax
.text:100015BF C3							       retn
.text:100015BF						       sub_100015AE    endp
.text:100015BF
.text:100015C0
.text:100015C0						       ; =============== S U B R O U T I N E =======================================
.text:100015C0
.text:100015C0						       ; Attributes: bp-based frame
.text:100015C0
.text:100015C0						       sub_100015C0    proc near	       ; CODE XREF: .text:1000136Ep
.text:100015C0
.text:100015C0						       var_1C	       = dword ptr -1Ch
.text:100015C0						       ms_exc	       = CPPEH_RECORD ptr -18h
.text:100015C0
.text:100015C0 6A 0C							       push    0Ch
.text:100015C2 68 18 21	00 10						       push    offset stru_10002118
.text:100015C7 E8 64 FF	FF FF						       call    __SEH_prolog
.text:100015CC C7 45 E4	FC 21 00 10					       mov     [ebp+var_1C], offset unk_100021FC
.text:100015D3
.text:100015D3						       loc_100015D3:			       ; CODE XREF: sub_100015C0+3Cj
.text:100015D3 81 7D E4	FC 21 00 10					       cmp     [ebp+var_1C], offset unk_100021FC
.text:100015DA 73 22							       jnb     short loc_100015FE
.text:100015DC 83 65 FC	00						       and     [ebp+ms_exc.registration.TryLevel], 0
.text:100015E0 8B 45 E4							       mov     eax, [ebp+var_1C]
.text:100015E3 8B 00							       mov     eax, [eax]
.text:100015E5 85 C0							       test    eax, eax
.text:100015E7 74 0B							       jz      short loc_100015F4
.text:100015E9 FF D0							       call    eax
.text:100015EB EB 07							       jmp     short loc_100015F4
.text:100015ED						       ; ---------------------------------------------------------------------------
.text:100015ED
.text:100015ED						       loc_100015ED:			       ; DATA XREF: .rdata:stru_10002118o
.text:100015ED 33 C0							       xor     eax, eax	       ; Exception filter 0 for	function 100015C0
.text:100015EF 40							       inc     eax
.text:100015F0 C3							       retn
.text:100015F1						       ; ---------------------------------------------------------------------------
.text:100015F1
.text:100015F1						       loc_100015F1:			       ; DATA XREF: .rdata:stru_10002118o
.text:100015F1 8B 65 E8							       mov     esp, [ebp+ms_exc.old_esp] ; Exception handler 0 for function 100015C0
.text:100015F4
.text:100015F4						       loc_100015F4:			       ; CODE XREF: sub_100015C0+27j
.text:100015F4											       ; sub_100015C0+2Bj
.text:100015F4 83 4D FC	FF						       or      [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
.text:100015F8 83 45 E4	04						       add     [ebp+var_1C], 4
.text:100015FC EB D5							       jmp     short loc_100015D3
.text:100015FE						       ; ---------------------------------------------------------------------------
.text:100015FE
.text:100015FE						       loc_100015FE:			       ; CODE XREF: sub_100015C0+1Aj
.text:100015FE E8 68 FF	FF FF						       call    __SEH_epilog
.text:10001603 C3							       retn
.text:10001603						       sub_100015C0    endp
.text:10001603
.text:10001604
.text:10001604						       ; =============== S U B R O U T I N E =======================================
.text:10001604
.text:10001604						       ; Attributes: bp-based frame
.text:10001604
.text:10001604						       sub_10001604    proc near	       ; DATA XREF: .text:10001373o
.text:10001604
.text:10001604						       var_1C	       = dword ptr -1Ch
.text:10001604						       ms_exc	       = CPPEH_RECORD ptr -18h
.text:10001604
.text:10001604 6A 0C							       push    0Ch
.text:10001606 68 28 21	00 10						       push    offset stru_10002128
.text:1000160B E8 20 FF	FF FF						       call    __SEH_prolog
.text:10001610 C7 45 E4	04 22 00 10					       mov     [ebp+var_1C], offset unk_10002204
.text:10001617
.text:10001617						       loc_10001617:			       ; CODE XREF: sub_10001604+3Cj
.text:10001617 81 7D E4	04 22 00 10					       cmp     [ebp+var_1C], offset unk_10002204
.text:1000161E 73 22							       jnb     short loc_10001642
.text:10001620 83 65 FC	00						       and     [ebp+ms_exc.registration.TryLevel], 0
.text:10001624 8B 45 E4							       mov     eax, [ebp+var_1C]
.text:10001627 8B 00							       mov     eax, [eax]
.text:10001629 85 C0							       test    eax, eax
.text:1000162B 74 0B							       jz      short loc_10001638
.text:1000162D FF D0							       call    eax
.text:1000162F EB 07							       jmp     short loc_10001638
.text:10001631						       ; ---------------------------------------------------------------------------
.text:10001631
.text:10001631						       loc_10001631:			       ; DATA XREF: .rdata:stru_10002128o
.text:10001631 33 C0							       xor     eax, eax	       ; Exception filter 0 for	function 10001604
.text:10001633 40							       inc     eax
.text:10001634 C3							       retn
.text:10001635						       ; ---------------------------------------------------------------------------
.text:10001635
.text:10001635						       loc_10001635:			       ; DATA XREF: .rdata:stru_10002128o
.text:10001635 8B 65 E8							       mov     esp, [ebp+ms_exc.old_esp] ; Exception handler 0 for function 10001604
.text:10001638
.text:10001638						       loc_10001638:			       ; CODE XREF: sub_10001604+27j
.text:10001638											       ; sub_10001604+2Bj
.text:10001638 83 4D FC	FF						       or      [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
.text:1000163C 83 45 E4	04						       add     [ebp+var_1C], 4
.text:10001640 EB D5							       jmp     short loc_10001617
.text:10001642						       ; ---------------------------------------------------------------------------
.text:10001642
.text:10001642						       loc_10001642:			       ; CODE XREF: sub_10001604+1Aj
.text:10001642 E8 24 FF	FF FF						       call    __SEH_epilog
.text:10001647 C3							       retn
.text:10001647						       sub_10001604    endp
.text:10001647
.text:10001648						       ; [00000006 BYTES: COLLAPSED FUNCTION __CppXcptFilter. PRESS KEYPAD CTRL-"+" TO EXPAND]
.text:1000164E						       ; ---------------------------------------------------------------------------
.text:1000164E 83 7C 24	08 01						       cmp     dword ptr [esp+8], 1
.text:10001653 75 13							       jnz     short loc_10001668
.text:10001655 83 3D 34	30 00 10 00					       cmp     dword_10003034, 0
.text:1000165C 75 0A							       jnz     short loc_10001668
.text:1000165E FF 74 24	04						       push    dword ptr [esp+4]
.text:10001662 FF 15 28	20 00 10					       call    ds:DisableThreadLibraryCalls
.text:10001668
.text:10001668						       loc_10001668:			       ; CODE XREF: .text:10001653j
.text:10001668											       ; .text:1000165Cj
.text:10001668 33 C0							       xor     eax, eax
.text:1000166A 40							       inc     eax
.text:1000166B C2 0C 00							       retn    0Ch
.text:1000166E						       ; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit. PRESS	KEYPAD CTRL-"+"	TO EXPAND]
.text:10001674 CC CC CC	CC CC CC CC CC CC CC CC	CC			       align 10h
.text:10001680
.text:10001680						       ; =============== S U B R O U T I N E =======================================
.text:10001680
.text:10001680
.text:10001680						       sub_10001680    proc near	       ; DATA XREF: .rdata:stru_10002208o
.text:10001680 8D 4D D8							       lea     ecx, [ebp-28h]
.text:10001683 FF 25 30	20 00 10					       jmp     ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:10001683						       sub_10001680    endp
.text:10001683
.text:10001689
.text:10001689						       ; =============== S U B R O U T I N E =======================================
.text:10001689
.text:10001689
.text:10001689						       sub_10001689    proc near	       ; DATA XREF: .rdata:stru_10002208o
.text:10001689 8B 45 D4							       mov     eax, [ebp-2Ch]
.text:1000168C 83 E0 01							       and     eax, 1
.text:1000168F 0F 84 0D	00 00 00					       jz      locret_100016A2
.text:10001695 83 65 D4	FE						       and     dword ptr [ebp-2Ch], 0FFFFFFFEh
.text:10001699 8B 4D 04							       mov     ecx, [ebp+4]
.text:1000169C FF 25 30	20 00 10					       jmp     ds:??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ; std::basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>::~basic_string<ushort,std::char_traits<ushort>,std::allocator<ushort>>(void)
.text:100016A2						       ; ---------------------------------------------------------------------------
.text:100016A2
.text:100016A2						       locret_100016A2:			       ; CODE XREF: sub_10001689+6j
.text:100016A2 C3							       retn
.text:100016A2						       sub_10001689    endp
.text:100016A2
.text:100016A3
.text:100016A3						       ; =============== S U B R O U T I N E =======================================
.text:100016A3
.text:100016A3
.text:100016A3						       SEH_10001000    proc near	       ; DATA XREF: sub_10001000+2o
.text:100016A3											       ; .rdata:100021F4o
.text:100016A3 B8 18 22	00 10						       mov     eax, offset stru_10002218
.text:100016A8 E9 29 FC	FF FF						       jmp     __CxxFrameHandler
.text:100016A8						       SEH_10001000    endp
.text:100016A8
.text:100016A8						       ; ---------------------------------------------------------------------------
.text:100016AD 00 00 00	00 00 00 00 00 00 00 00	00 00 00 00 00+		       align 200h
.text:10001800 ?? ?? ??	?? ?? ?? ?? ?? ?? ?? ??	?? ?? ?? ?? ??+		       dd 200h dup(?)
.text:10001800 ?? ?? ??	?? ?? ?? ?? ?? ?? ?? ??	?? ?? ?? ?? ??+_text	       ends
.text:10001800 ?? ?? ??	?? ?? ?? ?? ?? ?? ?? ??	?? ?? ?? ?? ??+
.idata:10002000							; Section 2. (virtual address 00002000)
.idata:10002000							; Virtual size			: 000006E1 (   1761.)
.idata:10002000							; Section size in file		: 00000800 (   2048.)
.idata:10002000							; Offset to raw	data for section: 00000C00
.idata:10002000							; Flags	40000040: Data Readable
.idata:10002000							; Alignment	: default
.idata:10002000							;
.idata:10002000							; Imports from KERNEL32.dll
.idata:10002000							;
.idata:10002000							; ===========================================================================
.idata:10002000
.idata:10002000							; Segment type:	Externs
.idata:10002000							; _idata
.idata:10002000							; BOOL __stdcall CloseHandle(HANDLE hObject)
.idata:10002000	?? ?? ?? ??							extrn CloseHandle:dword	; CODE XREF: RunPhotoDownloader+209p
.idata:10002000												; RunPhotoDownloader+210p
.idata:10002000												; DATA XREF: ...
.idata:10002004							; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
.idata:10002004	?? ?? ?? ??							extrn GetProcAddress:dword
.idata:10002004												; CODE XREF: RunPhotoDownloader+1B6p
.idata:10002004												; RunPhotoDownloader+1F8p
.idata:10002004												; DATA XREF: ...
.idata:10002008							; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
.idata:10002008	?? ?? ?? ??							extrn LoadLibraryA:dword
.idata:10002008												; CODE XREF: RunPhotoDownloader+19Bp
.idata:10002008												; DATA XREF: RunPhotoDownloader+19Br
.idata:1000200C							; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
.idata:1000200C	?? ?? ?? ??							extrn VirtualAlloc:dword
.idata:1000200C												; CODE XREF: RunPhotoDownloader+140p
.idata:1000200C												; .text:10001402p
.idata:1000200C												; DATA XREF: ...
.idata:10002010							; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
.idata:10002010	?? ?? ?? ??							extrn GetSystemTimeAsFileTime:dword
.idata:10002010												; CODE XREF: sub_100014C1+1Bp
.idata:10002010												; DATA XREF: sub_100014C1+1Br
.idata:10002014							; DWORD	__stdcall GetCurrentProcessId()
.idata:10002014	?? ?? ?? ??							extrn GetCurrentProcessId:dword
.idata:10002014												; CODE XREF: sub_100014C1+27p
.idata:10002014												; DATA XREF: sub_100014C1+27r
.idata:10002018							; DWORD	__stdcall GetCurrentThreadId()
.idata:10002018	?? ?? ?? ??							extrn GetCurrentThreadId:dword
.idata:10002018												; CODE XREF: sub_100014C1+2Fp
.idata:10002018												; DATA XREF: sub_100014C1+2Fr
.idata:1000201C							; DWORD	__stdcall GetTickCount()
.idata:1000201C	?? ?? ?? ??							extrn GetTickCount:dword
.idata:1000201C												; CODE XREF: sub_100014C1+37p
.idata:1000201C												; DATA XREF: sub_100014C1+37r
.idata:10002020							; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
.idata:10002020	?? ?? ?? ??							extrn QueryPerformanceCounter:dword
.idata:10002020												; CODE XREF: sub_100014C1+43p
.idata:10002020												; DATA XREF: sub_100014C1+43r
.idata:10002024							; void __stdcall ExitProcess(UINT uExitCode)
.idata:10002024	?? ?? ?? ??							extrn ExitProcess:dword	; CODE XREF: __security_check_cookie(x)-7p
.idata:10002024												; DATA XREF: __security_check_cookie(x)-7r
.idata:10002028							; BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule)
.idata:10002028	?? ?? ?? ??							extrn DisableThreadLibraryCalls:dword
.idata:10002028												; CODE XREF: .text:10001662p
.idata:10002028												; DATA XREF: .text:10001662r
.idata:1000202C
.idata:10002030							;
.idata:10002030							; Imports from MSVCP71.dll
.idata:10002030							;
.idata:10002030							; public: __thiscall std::basic_string<unsigned	short, struct std::char_traits<unsigned	short>,	class std::allocator<unsigned short>>::~basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>>(void)
.idata:10002030	?? ?? ?? ??							extrn ??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ:dword
.idata:10002030												; CODE XREF: sub_10001000+63p
.idata:10002030												; RunPhotoDownloader+BFp ...
.idata:10002034							; public: __thiscall std::basic_string<unsigned	short, struct std::char_traits<unsigned	short>,	class std::allocator<unsigned short>>::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>>(class std::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>> const	&)
.idata:10002034	?? ?? ?? ??							extrn ??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@ABV01@@Z:dword
.idata:10002034												; CODE XREF: sub_10001000+2Ap
.idata:10002034												; sub_10001000+4Cp
.idata:10002034												; DATA XREF: ...
.idata:10002038							; public: __thiscall std::basic_string<unsigned	short, struct std::char_traits<unsigned	short>,	class std::allocator<unsigned short>>::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>>(unsigned short const	*)
.idata:10002038	?? ?? ?? ??							extrn ??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@PBG@Z:dword
.idata:10002038												; CODE XREF: RunPhotoDownloader+74p
.idata:10002038												; DATA XREF: RunPhotoDownloader+74r
.idata:1000203C							; public: class	std::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>> & __thiscall std::basic_string<unsigned short,	struct std::char_traits<unsigned short>, class std::allocator<unsigned short>>::operator+=(unsigned short const	*)
.idata:1000203C	?? ?? ?? ??							extrn ??Y?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAEAAV01@PBG@Z:dword
.idata:1000203C												; CODE XREF: sub_10001000+3Fp
.idata:1000203C												; DATA XREF: sub_10001000+3Fr
.idata:10002040							; public: class	std::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>> & __thiscall std::basic_string<unsigned short,	struct std::char_traits<unsigned short>, class std::allocator<unsigned short>>::operator=(class	std::basic_string<unsigned short, struct std::char_traits<unsigned short>, class std::allocator<unsigned short>> const &)
.idata:10002040	?? ?? ?? ??							extrn ??4?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAEAAV01@ABV01@@Z:dword
.idata:10002040												; CODE XREF: RunPhotoDownloader+B5p
.idata:10002040												; RunPhotoDownloader+107p
.idata:10002040												; DATA XREF: ...
.idata:10002044
.idata:10002048							;
.idata:10002048							; Imports from MSVCR71.dll
.idata:10002048							;
.idata:10002048	?? ?? ?? ??							extrn __imp___CxxFrameHandler:dword
.idata:10002048												; DATA XREF: __CxxFrameHandlerr
.idata:10002048												; .rdata:10002280o
.idata:1000204C							; wchar_t *__cdecl ltow(__int32	Value, wchar_t *Dest, int Radix)
.idata:1000204C	?? ?? ?? ??							extrn _ltow:dword	; CODE XREF: RunPhotoDownloader+63p
.idata:1000204C												; DATA XREF: RunPhotoDownloader+63r
.idata:10002050	?? ?? ?? ??							extrn __imp___security_error_handler:dword
.idata:10002050												; DATA XREF: __security_error_handlerr
.idata:10002054	?? ?? ?? ??							extrn __imp__except_handler3:dword
.idata:10002054												; DATA XREF: _except_handler3r
.idata:10002058							; void __cdecl free(void *Memory)
.idata:10002058	?? ?? ?? ??							extrn free:dword	; CODE XREF: .text:100013C9p
.idata:10002058												; DATA XREF: .text:100013C9r
.idata:1000205C	?? ?? ?? ??							extrn __imp__initterm:dword
.idata:1000205C												; DATA XREF: _inittermr
.idata:10002060							; void *__cdecl	malloc(size_t Size)
.idata:10002060	?? ?? ?? ??							extrn malloc:dword	; CODE XREF: .text:1000134Dp
.idata:10002060												; DATA XREF: .text:1000134Dr
.idata:10002064	?? ?? ?? ??							extrn _adjust_fdiv:dword
.idata:10002064												; DATA XREF: .text:10001338r
.idata:10002068	?? ?? ?? ??							extrn __imp___CppXcptFilter:dword
.idata:10002068												; DATA XREF: __CppXcptFilterr
.idata:1000206C	?? ?? ?? ??							extrn __imp___dllonexit:dword
.idata:1000206C												; DATA XREF: __dllonexitr
.idata:10002070							; _onexit_t __cdecl onexit(_onexit_t Func)
.idata:10002070	?? ?? ?? ??							extrn _onexit:dword	; DATA XREF: sub_10001588+9r
.idata:10002074
.idata:10002078							;
.idata:10002078							; Imports from USER32.dll
.idata:10002078							;
.idata:10002078							; LRESULT __stdcall DispatchMessageW(const MSG *lpMsg)
.idata:10002078	?? ?? ?? ??							extrn DispatchMessageW:dword
.idata:10002078												; CODE XREF: RunPhotoDownloader+1EFp
.idata:10002078												; DATA XREF: RunPhotoDownloader+1C2r ...
.idata:1000207C							; BOOL __stdcall GetMessageW(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax)
.idata:1000207C	?? ?? ?? ??							extrn GetMessageW:dword	; CODE XREF: RunPhotoDownloader+1D3p
.idata:1000207C												; DATA XREF: RunPhotoDownloader+1BCr
.idata:10002080
.idata:10002080
.rdata:10002084							; ===========================================================================
.rdata:10002084
.rdata:10002084							; Segment type:	Pure data
.rdata:10002084							; Segment permissions: Read
.rdata:10002084							_rdata		segment	para public 'DATA' use32
.rdata:10002084									assume cs:_rdata
.rdata:10002084									;org 10002084h
.rdata:10002084	00 00 00 00 00 00 00 00	00 00 00 00				align 10h
.rdata:10002090	00 00 00 00					dword_10002090	dd 0			; DATA XREF: HEADER:10000198o
.rdata:10002090												; Characteristics
.rdata:10002094	AD 7E 09 43							dd 43097EADh		; TimeDateStamp
.rdata:10002098	00 00								dw 0			; MajorVersion
.rdata:1000209A	00 00								dw 0			; MinorVersion
.rdata:1000209C	02 00 00 00							dd 2			; Type:	The Visual C++ debug information
.rdata:100020A0	6F 00 00 00							dd 6Fh			; SizeOfData
.rdata:100020A4	80 21 00 00							dd rva asc_10002180	; AddressOfRawData
.rdata:100020A8	80 0D 00 00							dd rva unk_10000D80	; PointerToRawData
.rdata:100020AC	20						unk_100020AC	db  20h			; DATA XREF: RunPhotoDownloader+D7o
.rdata:100020AD	00								db    0
.rdata:100020AE	00								db    0
.rdata:100020AF	00								db    0
.rdata:100020B0							aParamsForceTru:			; DATA XREF: RunPhotoDownloader+36o
.rdata:100020B0	20 00 70 00 61 00 72 00	61 00 6D 00 73 00 20 00+		unicode	0, < params force=true parenthandle=>,0
.rdata:100020F2	00 00 00 00 00 00						align 8
.rdata:100020F8	FF						unk_100020F8	db 0FFh			; DATA XREF: __security_check_cookie(x)-2Fo
.rdata:100020F9	FF								db 0FFh
.rdata:100020FA	FF								db 0FFh
.rdata:100020FB	FF								db 0FFh
.rdata:100020FC	FD 12 00 10							dd offset sub_100012FD
.rdata:10002100	01 13 00 10							dd offset sub_10001301
.rdata:10002104	00 00 00 00							align 8
.rdata:10002108	FF								db 0FFh
.rdata:10002109	FF								db 0FFh
.rdata:1000210A	FF								db 0FFh
.rdata:1000210B	FF								db 0FFh
.rdata:1000210C	9F 14 00 10							dd offset sub_1000149F
.rdata:10002110	B0 14 00 10							dd offset sub_100014B0
.rdata:10002114	00 00 00 00							align 8
.rdata:10002118	FF FF FF FF ED 15 00 10	F1 15 00 10		stru_10002118	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_100015ED, \
.rdata:10002118												; DATA XREF: sub_100015C0+2o
.rdata:10002118											   offset loc_100015F1>	; SEH scope table for function 100015C0
.rdata:10002124	00 00 00 00							align 8
.rdata:10002128	FF FF FF FF 31 16 00 10	35 16 00 10		stru_10002128	_SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_10001631, \
.rdata:10002128												; DATA XREF: sub_10001604+2o
.rdata:10002128											   offset loc_10001635>	; SEH scope table for function 10001604
.rdata:10002134	00 00 00 00							align 8
.rdata:10002138	48 00 00 00					__load_config_used dd 48h		; DATA XREF: HEADER:100001B8o
.rdata:10002138												; Size
.rdata:1000213C	00 00 00 00							dd 0			; Time stamp
.rdata:10002140	00 00 00 00							dw 2 dup(0)		; Version: 0.0
.rdata:10002144	00 00 00 00							dd 0			; GlobalFlagsClear
.rdata:10002148	00 00 00 00							dd 0			; GlobalFlagsSet
.rdata:1000214C	00 00 00 00							dd 0			; CriticalSectionDefaultTimeout
.rdata:10002150	00 00 00 00							dd 0			; DeCommitFreeBlockThreshold
.rdata:10002154	00 00 00 00							dd 0			; DeCommitTotalFreeThreshold
.rdata:10002158	00 00 00 00							dd 0			; LockPrefixTable
.rdata:1000215C	00 00 00 00							dd 0			; MaximumAllocationSize
.rdata:10002160	00 00 00 00							dd 0			; VirtualMemoryThreshold
.rdata:10002164	00 00 00 00							dd 0			; ProcessAffinityMask
.rdata:10002168	00 00 00 00							dd 0			; ProcessHeapFlags
.rdata:1000216C	00 00								dw 0			; CSDVersion
.rdata:1000216E	00 00								dw 0			; Reserved1
.rdata:10002170	00 00 00 00							dd 0			; EditList
.rdata:10002174	20 30 00 10							dd offset ___security_cookie ; SecurityCookie
.rdata:10002178	F0 21 00 10							dd offset ___safe_se_handler_table ; SEHandlerTable
.rdata:1000217C	02 00 00 00							dd 2			; SEHandlerCount
.rdata:10002180							; Debug	information
.rdata:10002180	52 53 44 53					asc_10002180	db 'RSDS'               ; DATA XREF: .rdata:100020A4o
.rdata:10002180												; CV signature
.rdata:10002184	7F								db  7Fh	; 		; GUID
.rdata:10002185	56								db  56h	; V
.rdata:10002186	25								db  25h	; %
.rdata:10002187	F6								db 0F6h	; 
.rdata:10002188	24								db  24h	; $
.rdata:10002189	3D								db  3Dh	; =
.rdata:1000218A	3D								db  3Dh	; =
.rdata:1000218B	4E								db  4Eh	; N
.rdata:1000218C	8D								db  8Dh	; 
.rdata:1000218D	A7								db 0A7h	; 
.rdata:1000218E	CA								db 0CAh	; 
.rdata:1000218F	7D								db  7Dh	; }
.rdata:10002190	BC								db 0BCh	; 
.rdata:10002191	B3								db 0B3h	; 
.rdata:10002192	96								db  96h	; 
.rdata:10002193	77								db  77h	; w
.rdata:10002194	01 00 00 00							dd 1			; Age
.rdata:10002198	63 3A 5C 41 64 6F 62 65	50 68 6F 74 6F 44 6F 77+		db 'c:\AdobePhotoDownloader\di\album-lite\chamak_apd\build\pmm\apdhoo' ; PdbFileName
.rdata:10002198	6E 6C 6F 61 64 65 72 5C	64 69 5C 61 6C 62 75 6D+		db 'k\Release\apdhook.pdb',0
.rdata:100021EF	00								align 10h
.rdata:100021F0	7C 15 00 00					___safe_se_handler_table dd rva	_except_handler3
.rdata:100021F0												; DATA XREF: .rdata:10002178o
.rdata:100021F4	A3 16 00 00							dd rva SEH_10001000
.rdata:100021F8	00								db    0
.rdata:100021F9	00								db    0
.rdata:100021FA	00								db    0
.rdata:100021FB	00								db    0
.rdata:100021FC	00						unk_100021FC	db    0			; DATA XREF: sub_100015C0+Co
.rdata:100021FC												; sub_100015C0:loc_100015D3o
.rdata:100021FD	00								db    0
.rdata:100021FE	00								db    0
.rdata:100021FF	00								db    0
.rdata:10002200	00								db    0
.rdata:10002201	00								db    0
.rdata:10002202	00								db    0
.rdata:10002203	00								db    0
.rdata:10002204	00						unk_10002204	db    0			; DATA XREF: sub_10001604+Co
.rdata:10002204												; sub_10001604:loc_10001617o
.rdata:10002205	00								db    0
.rdata:10002206	00								db    0
.rdata:10002207	00								db    0
.rdata:10002208	FF FF FF FF 89 16 00 10	00 00 00 00 80 16 00 10	stru_10002208	_msExcInfo <-1,	offset sub_10001689>
.rdata:10002208												; DATA XREF: .rdata:stru_10002218o
.rdata:10002208									_msExcInfo <0, offset sub_10001680>
.rdata:10002218	20 05 93 19 02 00 00 00	08 22 00 10 00 00 00 00+stru_10002218	_msExcept7 <19930520h, 2, offset stru_10002208,	0, 0, 0>
.rdata:10002218	00 00 00 00 00 00 00 00	00 00 00 00							; DATA XREF: SEH_10001000o
.rdata:10002234	98 22 00 00					__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_10002298
.rdata:10002234												; DATA XREF: HEADER:10000170o
.rdata:10002234												; Import Name Table
.rdata:10002238	00 00 00 00							dd 0			; Time stamp
.rdata:1000223C	00 00 00 00							dd 0			; Forwarder Chain
.rdata:10002240	68 23 00 00							dd rva aKernel32_dll	; DLL Name
.rdata:10002244	00 20 00 00							dd rva CloseHandle	; Import Address Table
.rdata:10002248	10 23 00 00					__IMPORT_DESCRIPTOR_USER32 dd rva off_10002310 ; Import	Name Table
.rdata:1000224C	00 00 00 00							dd 0			; Time stamp
.rdata:10002250	00 00 00 00							dd 0			; Forwarder Chain
.rdata:10002254	98 23 00 00							dd rva aUser32_dll	; DLL Name
.rdata:10002258	78 20 00 00							dd rva DispatchMessageW	; Import Address Table
.rdata:1000225C	C8 22 00 00					__IMPORT_DESCRIPTOR_MSVCP71 dd rva off_100022C8	; Import Name Table
.rdata:10002260	00 00 00 00							dd 0			; Time stamp
.rdata:10002264	00 00 00 00							dd 0			; Forwarder Chain
.rdata:10002268	30 25 00 00							dd rva aMsvcp71_dll	; DLL Name
.rdata:1000226C	30 20 00 00							dd rva ??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@QAE@XZ ;	Import Address Table
.rdata:10002270	E0 22 00 00					__IMPORT_DESCRIPTOR_MSVCR71 dd rva off_100022E0	; Import Name Table
.rdata:10002274	00 00 00 00							dd 0			; Time stamp
.rdata:10002278	00 00 00 00							dd 0			; Forwarder Chain
.rdata:1000227C	58 25 00 00							dd rva aMsvcr71_dll	; DLL Name
.rdata:10002280	48 20 00 00							dd rva __imp___CxxFrameHandler ; Import	Address	Table
.rdata:10002284	00								db    0
.rdata:10002285	00								db    0
.rdata:10002286	00								db    0
.rdata:10002287	00								db    0
.rdata:10002288	00								db    0
.rdata:10002289	00								db    0
.rdata:1000228A	00								db    0
.rdata:1000228B	00								db    0
.rdata:1000228C	00								db    0
.rdata:1000228D	00								db    0
.rdata:1000228E	00								db    0
.rdata:1000228F	00								db    0
.rdata:10002290	00								db    0
.rdata:10002291	00								db    0
.rdata:10002292	00								db    0
.rdata:10002293	00								db    0
.rdata:10002294	00								db    0
.rdata:10002295	00								db    0
.rdata:10002296	00								db    0
.rdata:10002297	00								db    0
.rdata:10002298							;
.rdata:10002298							; Import names for KERNEL32.dll
.rdata:10002298							;
.rdata:10002298	1C 23 00 00					off_10002298	dd rva word_1000231C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
.rdata:1000229C	2A 23 00 00							dd rva word_1000232A
.rdata:100022A0	40 23 00 00							dd rva word_10002340
.rdata:100022A4	52 23 00 00							dd rva word_10002352
.rdata:100022A8	50 26 00 00							dd rva word_10002650
.rdata:100022AC	3A 26 00 00							dd rva word_1000263A
.rdata:100022B0	24 26 00 00							dd rva word_10002624
.rdata:100022B4	14 26 00 00							dd rva word_10002614
.rdata:100022B8	FA 25 00 00							dd rva word_100025FA
.rdata:100022BC	EC 25 00 00							dd rva word_100025EC
.rdata:100022C0	6A 26 00 00							dd rva word_1000266A
.rdata:100022C4	00 00 00 00							dd 0
.rdata:100022C8							;
.rdata:100022C8							; Import names for MSVCP71.dll
.rdata:100022C8							;
.rdata:100022C8	A4 23 00 00					off_100022C8	dd rva word_100023A4	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCP71o
.rdata:100022CC	EE 23 00 00							dd rva word_100023EE
.rdata:100022D0	3E 24 00 00							dd rva word_1000243E
.rdata:100022D4	8A 24 00 00							dd rva word_1000248A
.rdata:100022D8	DC 24 00 00							dd rva word_100024DC
.rdata:100022DC	00 00 00 00							dd 0
.rdata:100022E0							;
.rdata:100022E0							; Import names for MSVCR71.dll
.rdata:100022E0							;
.rdata:100022E0	3C 25 00 00					off_100022E0	dd rva word_1000253C	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCR71o
.rdata:100022E4	50 25 00 00							dd rva word_10002550
.rdata:100022E8	64 25 00 00							dd rva word_10002564
.rdata:100022EC	80 25 00 00							dd rva word_10002580
.rdata:100022F0	94 25 00 00							dd rva word_10002594
.rdata:100022F4	9C 25 00 00							dd rva word_1000259C
.rdata:100022F8	A8 25 00 00							dd rva word_100025A8
.rdata:100022FC	B2 25 00 00							dd rva word_100025B2
.rdata:10002300	C2 25 00 00							dd rva word_100025C2
.rdata:10002304	D4 25 00 00							dd rva word_100025D4
.rdata:10002308	E2 25 00 00							dd rva word_100025E2
.rdata:1000230C	00 00 00 00							dd 0
.rdata:10002310							;
.rdata:10002310							; Import names for USER32.dll
.rdata:10002310							;
.rdata:10002310	76 23 00 00					off_10002310	dd rva word_10002376	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
.rdata:10002314	8A 23 00 00							dd rva word_1000238A
.rdata:10002318	00 00 00 00							dd 0
.rdata:1000231C	2E 00						word_1000231C	dw 2Eh			; DATA XREF: .rdata:off_10002298o
.rdata:1000231E	43 6C 6F 73 65 48 61 6E	64 6C 65 00				db 'CloseHandle',0
.rdata:1000232A	83 03						word_1000232A	dw 383h			; DATA XREF: .rdata:1000229Co
.rdata:1000232C	47 65 74 50 72 6F 63 41	64 64 72 65 73 73 00			db 'GetProcAddress',0
.rdata:1000233B	00 00 00 00 00							align 10h
.rdata:10002340	63 00						word_10002340	dw 63h			; DATA XREF: .rdata:100022A0o
.rdata:10002342	4C 6F 61 64 4C 69 62 72	61 72 79 41 00				db 'LoadLibraryA',0
.rdata:1000234F	00								db    0
.rdata:10002350	00								db    0
.rdata:10002351	00								db    0
.rdata:10002352	82 02						word_10002352	dw 282h			; DATA XREF: .rdata:100022A4o
.rdata:10002354	56 69 72 74 75 61 6C 41	6C 6C 6F 63 00				db 'VirtualAlloc',0
.rdata:10002361	00 00 00 00 00 00 00						align 8
.rdata:10002368	4B 45 52 4E 45 4C 33 32	2E 64 6C 6C 00		aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:10002240o
.rdata:10002375	00								align 2
.rdata:10002376	A2 00						word_10002376	dw 0A2h			; DATA XREF: .rdata:off_10002310o
.rdata:10002378	44 69 73 70 61 74 63 68	4D 65 73 73 61 67 65 57+		db 'DispatchMessageW',0
.rdata:10002389	00								align 2
.rdata:1000238A	3E 01						word_1000238A	dw 13Eh			; DATA XREF: .rdata:10002314o
.rdata:1000238C	47 65 74 4D 65 73 73 61	67 65 57 00				db 'GetMessageW',0
.rdata:10002398	55 53 45 52 33 32 2E 64	6C 6C 00		aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:10002254o
.rdata:100023A3	00								align 4
.rdata:100023A4	20 02						word_100023A4	dw 220h			; DATA XREF: .rdata:off_100022C8o
.rdata:100023A6	3F 3F 31 3F 24 62 61 73	69 63 5F 73 74 72 69 6E+		db '??1?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@Q'
.rdata:100023A6	67 40 47 55 3F 24 63 68	61 72 5F 74 72 61 69 74+		db 'AE@XZ',0
.rdata:100023ED	00								align 2
.rdata:100023EE	5E 01						word_100023EE	dw 15Eh			; DATA XREF: .rdata:100022CCo
.rdata:100023F0	3F 3F 30 3F 24 62 61 73	69 63 5F 73 74 72 69 6E+		db '??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@Q'
.rdata:100023F0	67 40 47 55 3F 24 63 68	61 72 5F 74 72 61 69 74+		db 'AE@ABV01@@Z',0
.rdata:1000243D	00								align 2
.rdata:1000243E	65 01						word_1000243E	dw 165h			; DATA XREF: .rdata:100022D0o
.rdata:10002440	3F 3F 30 3F 24 62 61 73	69 63 5F 73 74 72 69 6E+		db '??0?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@Q'
.rdata:10002440	67 40 47 55 3F 24 63 68	61 72 5F 74 72 61 69 74+		db 'AE@PBG@Z',0
.rdata:1000248A	16 03						word_1000248A	dw 316h			; DATA XREF: .rdata:100022D4o
.rdata:1000248C	3F 3F 59 3F 24 62 61 73	69 63 5F 73 74 72 69 6E+		db '??Y?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@Q'
.rdata:1000248C	67 40 47 55 3F 24 63 68	61 72 5F 74 72 61 69 74+		db 'AEAAV01@PBG@Z',0
.rdata:100024DB	00								align 4
.rdata:100024DC	71 02						word_100024DC	dw 271h			; DATA XREF: .rdata:100022D8o
.rdata:100024DE	3F 3F 34 3F 24 62 61 73	69 63 5F 73 74 72 69 6E+		db '??4?$basic_string@GU?$char_traits@G@std@@V?$allocator@G@2@@std@@Q'
.rdata:100024DE	67 40 47 55 3F 24 63 68	61 72 5F 74 72 61 69 74+		db 'AEAAV01@ABV01@@Z',0
.rdata:10002530	4D 53 56 43 50 37 31 2E	64 6C 6C 00		aMsvcp71_dll	db 'MSVCP71.dll',0      ; DATA XREF: .rdata:10002268o
.rdata:1000253C	51 00						word_1000253C	dw 51h			; DATA XREF: .rdata:off_100022E0o
.rdata:1000253E	5F 5F 43 78 78 46 72 61	6D 65 48 61 6E 64 6C 65+		db '__CxxFrameHandler',0
.rdata:10002550	78 01						word_10002550	dw 178h			; DATA XREF: .rdata:100022E4o
.rdata:10002552	5F 6C 74 6F 77 00						db '_ltow',0
.rdata:10002558	4D 53 56 43 52 37 31 2E	64 6C 6C 00		aMsvcr71_dll	db 'MSVCR71.dll',0      ; DATA XREF: .rdata:1000227Co
.rdata:10002564	9B 00						word_10002564	dw 9Bh			; DATA XREF: .rdata:100022E8o
.rdata:10002566	5F 5F 73 65 63 75 72 69	74 79 5F 65 72 72 6F 72+		db '__security_error_handler',0
.rdata:1000257F	00								align 10h
.rdata:10002580	F1 00						word_10002580	dw 0F1h			; DATA XREF: .rdata:100022ECo
.rdata:10002582	5F 65 78 63 65 70 74 5F	68 61 6E 64 6C 65 72 33+		db '_except_handler3',0
.rdata:10002593	00								align 4
.rdata:10002594	AC 02						word_10002594	dw 2ACh			; DATA XREF: .rdata:100022F0o
.rdata:10002596	66 72 65 65 00							db 'free',0
.rdata:1000259B	00								align 4
.rdata:1000259C	3F 01						word_1000259C	dw 13Fh			; DATA XREF: .rdata:100022F4o
.rdata:1000259E	5F 69 6E 69 74 74 65 72	6D 00					db '_initterm',0
.rdata:100025A8	DF 02						word_100025A8	dw 2DFh			; DATA XREF: .rdata:100022F8o
.rdata:100025AA	6D 61 6C 6C 6F 63 00						db 'malloc',0
.rdata:100025B1	00								align 2
.rdata:100025B2	BB 00						word_100025B2	dw 0BBh			; DATA XREF: .rdata:100022FCo
.rdata:100025B4	5F 61 64 6A 75 73 74 5F	66 64 69 76 00				db '_adjust_fdiv',0
.rdata:100025C1	00								align 2
.rdata:100025C2	4C 00						word_100025C2	dw 4Ch			; DATA XREF: .rdata:10002300o
.rdata:100025C4	5F 5F 43 70 70 58 63 70	74 46 69 6C 74 65 72 00			db '__CppXcptFilter',0
.rdata:100025D4	6B 00						word_100025D4	dw 6Bh			; DATA XREF: .rdata:10002304o
.rdata:100025D6	5F 5F 64 6C 6C 6F 6E 65	78 69 74 00				db '__dllonexit',0
.rdata:100025E2	B8 01						word_100025E2	dw 1B8h			; DATA XREF: .rdata:10002308o
.rdata:100025E4	5F 6F 6E 65 78 69 74 00						db '_onexit',0
.rdata:100025EC	AF 00						word_100025EC	dw 0AFh			; DATA XREF: .rdata:100022BCo
.rdata:100025EE	45 78 69 74 50 72 6F 63	65 73 73 00				db 'ExitProcess',0
.rdata:100025FA	97 02						word_100025FA	dw 297h			; DATA XREF: .rdata:100022B8o
.rdata:100025FC	51 75 65 72 79 50 65 72	66 6F 72 6D 61 6E 63 65+		db 'QueryPerformanceCounter',0
.rdata:10002614	D5 01						word_10002614	dw 1D5h			; DATA XREF: .rdata:100022B4o
.rdata:10002616	47 65 74 54 69 63 6B 43	6F 75 6E 74 00				db 'GetTickCount',0
.rdata:10002623	00								align 4
.rdata:10002624	3E 01						word_10002624	dw 13Eh			; DATA XREF: .rdata:100022B0o
.rdata:10002626	47 65 74 43 75 72 72 65	6E 74 54 68 72 65 61 64+		db 'GetCurrentThreadId',0
.rdata:10002639	00								align 2
.rdata:1000263A	3B 01						word_1000263A	dw 13Bh			; DATA XREF: .rdata:100022ACo
.rdata:1000263C	47 65 74 43 75 72 72 65	6E 74 50 72 6F 63 65 73+		db 'GetCurrentProcessId',0
.rdata:10002650	C0 01						word_10002650	dw 1C0h			; DATA XREF: .rdata:100022A8o
.rdata:10002652	47 65 74 53 79 73 74 65	6D 54 69 6D 65 41 73 46+		db 'GetSystemTimeAsFileTime',0
.rdata:1000266A	84 00						word_1000266A	dw 84h			; DATA XREF: .rdata:100022C0o
.rdata:1000266C	44 69 73 61 62 6C 65 54	68 72 65 61 64 4C 69 62+		db 'DisableThreadLibraryCalls',0
.rdata:10002686	00 00 00 00 00 00 00 00	00 00					align 10h
.rdata:10002690							;
.rdata:10002690							; Export directory for apdhook.dll
.rdata:10002690							;
.rdata:10002690	00 00 00 00					dword_10002690	dd 0			; DATA XREF: HEADER:10000168o
.rdata:10002690												; Characteristics
.rdata:10002694	AD 7E 09 43							dd 43097EADh		; TimeDateStamp: Mon Aug 22 07:28:45 2005
.rdata:10002698	00 00								dw 0			; MajorVersion
.rdata:1000269A	00 00								dw 0			; MinorVersion
.rdata:1000269C	C2 26 00 00							dd rva aApdhook_dll	; Name
.rdata:100026A0	01 00 00 00							dd 1			; Base
.rdata:100026A4	01 00 00 00							dd 1			; NumberOfFunctions
.rdata:100026A8	01 00 00 00							dd 1			; NumberOfNames
.rdata:100026AC	B8 26 00 00							dd rva off_100026B8	; AddressOfFunctions
.rdata:100026B0	BC 26 00 00							dd rva off_100026BC	; AddressOfNames
.rdata:100026B4	C0 26 00 00							dd rva word_100026C0	; AddressOfNameOrdinals
.rdata:100026B8							;
.rdata:100026B8							; Export Address Table for apdhook.dll
.rdata:100026B8							;
.rdata:100026B8	80 10 00 00					off_100026B8	dd rva RunPhotoDownloader
.rdata:100026B8												; DATA XREF: .rdata:100026ACo
.rdata:100026BC							;
.rdata:100026BC							; Export Names Table for apdhook.dll
.rdata:100026BC							;
.rdata:100026BC	CE 26 00 00					off_100026BC	dd rva aRunphotodownlo	; DATA XREF: .rdata:100026B0o
.rdata:100026BC												; "RunPhotoDownloader"
.rdata:100026C0							;
.rdata:100026C0							; Export Ordinals Table	for apdhook.dll
.rdata:100026C0							;
.rdata:100026C0	00 00						word_100026C0	dw 0			; DATA XREF: .rdata:100026B4o
.rdata:100026C2	61 70 64 68 6F 6F 6B 2E	64 6C 6C 00		aApdhook_dll	db 'apdhook.dll',0      ; DATA XREF: .rdata:1000269Co
.rdata:100026CE	52 75 6E 50 68 6F 74 6F	44 6F 77 6E 6C 6F 61 64+aRunphotodownlo	db 'RunPhotoDownloader',0
.rdata:100026CE	65 72 00										; DATA XREF: .rdata:off_100026BCo
.rdata:100026E1	00 00 00 00 00 00 00 00	00 00 00 00 00 00 00 00+		align 1000h
.rdata:100026E1	00 00 00 00 00 00 00 00	00 00 00 00 00 00 00 00+_rdata		ends
.rdata:100026E1	00 00 00 00 00 00 00 00	00 00 00 00 00 00 00 00+
.data:10003000						       ; Section 3. (virtual address 00003000)
.data:10003000						       ; Virtual size		       : 00000038 (	56.)
.data:10003000						       ; Section size in file	       : 00000200 (    512.)
.data:10003000						       ; Offset	to raw data for	section: 00001400
.data:10003000						       ; Flags C0000040: Data Readable Writable
.data:10003000						       ; Alignment     : default
.data:10003000						       ; ===========================================================================
.data:10003000
.data:10003000						       ; Segment type: Pure data
.data:10003000						       ; Segment permissions: Read/Write
.data:10003000						       _data	       segment para public 'DATA' use32
.data:10003000								       assume cs:_data
.data:10003000								       ;org 10003000h
.data:10003000 00					       unk_10003000    db    0		       ; DATA XREF: HEADER:10000244o
.data:10003000											       ; .text:10001384o
.data:10003001 00							       db    0
.data:10003002 00							       db    0
.data:10003003 00							       db    0
.data:10003004 C1 14 00	10						       dd offset sub_100014C1
.data:10003008 00					       unk_10003008    db    0		       ; DATA XREF: .text:1000137Do
.data:10003009 00							       db    0
.data:1000300A 00							       db    0
.data:1000300B 00							       db    0
.data:1000300C 00							       db    0
.data:1000300D 00							       db    0
.data:1000300E 00							       db    0
.data:1000300F 00							       db    0
.data:10003010 00							       db    0
.data:10003011 00							       db    0
.data:10003012 00							       db    0
.data:10003013 00							       db    0
.data:10003014 00							       db    0
.data:10003015 00							       db    0
.data:10003016 00							       db    0
.data:10003017 00							       db    0
.data:10003018 00							       db    0
.data:10003019 00							       db    0
.data:1000301A 00							       db    0
.data:1000301B 00							       db    0
.data:1000301C 00							       db    0
.data:1000301D 00							       db    0
.data:1000301E 00							       db    0
.data:1000301F 00							       db    0
.data:10003020 4E E6 40	BB				       ___security_cookie dd 0BB40E64Eh	       ; DATA XREF: RunPhotoDownloader+11r
.data:10003020											       ; __security_check_cookie(x)r ...
.data:10003024 00 00 00	00				       dword_10003024  dd 0		       ; DATA XREF: .text:10001327r
.data:10003024											       ; .text:1000132Fw ...
.data:10003028 00 00 00	00				       dword_10003028  dd 0		       ; DATA XREF: .text:10001340w
.data:1000302C 00 00 00	00				       dword_1000302C  dd 0		       ; DATA XREF: .text:10001369w
.data:1000302C											       ; .text:loc_100013A6r ...
.data:10003030 00 00 00	00				       dword_10003030  dd 0		       ; DATA XREF: .text:10001356w
.data:10003030											       ; .text:10001364r ...
.data:10003034 00 00 00	00				       dword_10003034  dd 0		       ; DATA XREF: .text:10001484o
.data:10003034											       ; .text:10001655r
.data:10003038 00 00 00	00 00 00 00 00 00 00 00	00 00 00 00 00+		       align 1000h
.data:10003038 00 00 00	00 00 00 00 00 00 00 00	00 00 00 00 00+_data	       ends
.data:10003038 00 00 00	00 00 00 00 00 00 00 00	00 00 00 00 00+
.rsrc:10004000						       ; ===========================================================================
.rsrc:10004000
.rsrc:10004000						       ; [0002C000 BYTES: COLLAPSED SEGMENT _rsrc. PRESS KEYPAD	CTRL-"+" TO EXPAND]
.reloc:10030000							; ===========================================================================
.reloc:10030000
.reloc:10030000							; [00001000 BYTES: COLLAPSED SEGMENT _reloc. PRESS KEYPAD CTRL-"+" TO EXPAND]
